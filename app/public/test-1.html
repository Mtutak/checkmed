<!DOCTYPE html>
<html lang="en">
<head>
  <title>CheckMed</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>

<!-- Top Nav Bar Container For Walking Through Each Step -->
 <div class="container">
	    <div class="row form-group">
            <div class="col-xs-12">
                <h1>Build A Check List</h1>
                <ul class="nav nav-pills nav-justified thumbnail setup-panel">
                    <li class="active"><a href="#step-1">
                        <h4 class="list-group-item-heading">Step 1</h4>
                        <p class="list-group-item-text">Select Role and Use</p>
                    </a></li>
                    <li class="disabled"><a href="#step-2">
                        <h4 class="list-group-item-heading">Step 2</h4>
                        <p class="list-group-item-text">Symptoms</p>
                    </a></li>
                    <li class="disabled"><a href="#step-3">
                        <h4 class="list-group-item-heading">Step 3</h4>
                        <p class="list-group-item-text">Physical Exam</p>
                    </a></li>
                    <li class="disabled"><a href="#step-4">
                        <h4 class="list-group-item-heading">Step 4</h4>
                        <p class="list-group-item-text">Labs</p>
                    </a></li>    
                </ul>
            </div>
	    </div>
    </div>	

    <!-- ADD A BUTTON ON CLICK THAT CREATES ANOTHER FORM GROUP -->
<!-- Start of Form Step 1 -->
<form class="container">

    <div class="row setup-content" id="step-1">
        <div class="col-xs-12">
            <div class="col-md-12 well text-center">
                <h1> STEP 1</h1>

<!-- form -->
<form class="form-horizontal">
  <div class="form-group row">
    <div class="col-md-12">
            <h1 class="col-sm-2 control-label">Select Role!</h1>
            <label>Enter Checklist Name:<input id='checkTitle' type="text" class="form-control"  name="title"></label>
        <div class="col-sm-10">

          <label><input type="radio" class="form-control"  name="roleradio">Doctor</label>
          <label><input type="radio" class="form-control"  name="roleradio">Doctor2</label>
          <label><input type="radio" class="form-control"  name="roleradio">Doctor3</label>
          <label><input type="radio" class="form-control"  name="roleradio">Doctor4</label>
          <label><input type="radio" class="form-control"  name="roleradio">Doctor5</label>
        </div>
    </div>
  </div>
  <div class="form-group">
        <label class="col-sm-2 control-label">Checklists for:</label>
        <div class="col-sm-10">
            <label>
              <input type="checkbox" class="form-control" >
              Medical Students
            </label>
            <label>
              <input type="checkbox" class="form-control" >
              Interns
            </label>
            <label>
              <input type="checkbox" class="form-control" >
              Nursing Staff
            </label>
            <label>
              <input type="checkbox" class="form-control" >
              Pharmacists
            </label>
        </div>
  </div>
                
                <button id="activate-step-2" class="btn btn-primary btn-md">Next Step 2</button>

          </div>
        </div>
    </div>


<!-- form end -->

<div class="container">

    <div class="row setup-content" id="step-2">
        <div class="col-xs-12">
            <div class="col-md-12 well text-center">
                <h1 class="text-center"> Creates a Checklist of Symptoms</h1>
                
<!--<form></form> --> 
                <!-- <form> -->               
                
    <div class="container col-xs-12">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <!-- table formating -->
                <table class="table table-bordered table-hover" id="tab_logic">
                <thead>
                    <tr >
                        <th class="text-center">
                            #
                        </th>
                        <th class="text-center">
                            Symptoms
                        </th>                   
                        
                    </tr>
                </thead>
                <tbody>
                    <tr id='addr0'>
                        <td>
                        1
                        </td>
                        <td>
                        <input class="checkSym" type="text" name='name0'  placeholder='Enter Symptom' class="form-control"/>
                        </td>
                    </tr>
                    <tr id='addr1'></tr>
                </tbody>
                </table>
            </div>
        </div>
        <a id="add_row" class="btn btn-success pull-left">Add Row</a><a id='delete_row' class="btn btn-danger pull-right">Delete Row</a>
    </div>
                
<!-- </form> -->
                
                <button id="activate-step-3" class="btn btn-primary btn-md">Next Step 3</button>
            </div>
        </div>
    </div>

</div>

<!-- 
PHYSICAL EXAM CHECK STEP 3

 -->
<div class="container">

    <div class="row setup-content" id="step-3">
        <div class="col-xs-12">
            <div class="col-md-12 well text-center">
                <h1 class="text-center"> Physical Exam Checks</h1>
                
<!--<form></form> --> 
            <div class="container col-xs-12">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <!-- table formating -->
                <table class="table table-bordered table-hover" id="tab_logic_exam">
                <thead>
                    <tr >
                        <th class="text-center">
                            #
                        </th>
                        <th class="text-center">
                            Exam
                        </th>                   
                        
                    </tr>
                </thead>
                <tbody>
                    <tr id='examAddr0'>
                        <td>
                        1
                        </td>
                        <td>
                        <input class='checkExam' type="text" name='exam0'  placeholder='Enter Physical Exam Item' class="form-control"/>
                        </td>
                    </tr>
                    <tr id='examAddr1'></tr>
                </tbody>
                </table>
            </div>
        </div>
        <a id="add_row_exam" class="btn btn-success pull-left">Add Row</a>
        <a id="delete_row_exam" class="btn btn-danger pull-right">Delete Row</a>
    </div>
                
                <button id="activate-step-4" class="btn btn-primary btn-md">Next Step 4</button>
            </div>
        </div>
    </div>

</div>

<!-- 
LABS CHECKLIST FOR STEP 4

 -->
<div class="container">
    
    <div class="row setup-content" id="step-4">
        <div class="col-xs-12">
            <div class="col-md-12 well text-center">
                <h1 class="text-center"> LABS </h1>
                
<!--<form></form> -->                
                          <div class="container col-xs-12">
        <div class="row clearfix">
            <div class="col-md-12 column">
                <!-- table formating -->
                <table class="table table-bordered table-hover" id="tab_logic_lab">
                <thead>
                    <tr >
                        <th class="text-center">
                            #
                        </th>
                        <th class="text-center">
                            Lab
                        </th>                   
                        
                    </tr>
                </thead>
                <tbody>
                    <tr id='labAddr0'>
                        <td>
                        1
                        </td>
                        <td>
                        <input class='checkLab' type="text" name='lab0'  placeholder='Enter Lab' class="form-control"/>
                        </td>
                    </tr>
                    <tr id='labAddr1'></tr>
                </tbody>
                </table>
            </div>
        </div>
        <a id="add_row_lab" class="btn btn-success pull-left">Add Row</a>
        <a id="delete_row_lab" class="btn btn-danger pull-right">Delete Row</a>
         <button id="checkSubmit" class="btn btn-primary btn-md">Submit Checklist</button>
    </div>
            </div>
        </div>
    </div>

</form>
<script src="https://www.gstatic.com/firebasejs/3.6.7/firebase.js"></script>
<script type="text/javascript">
    // Activate Next Step
var currentUser = '';
var email = '';
$(document).ready(function() {
    // Initialize Firebase
var config = {
    apiKey: "AIzaSyBS6q1-rBjsJ2bjpNHRY_Bpju6lu0s4_yc",
    authDomain: "checkmed-2b213.firebaseapp.com",
    databaseURL: "https://checkmed-2b213.firebaseio.com",
    storageBucket: "checkmed-2b213.appspot.com",
    messagingSenderId: "843994433143"
};
firebase.initializeApp(config);

var dataRef = firebase.database();


//Get Active User Profile and Add to DB
firebase.auth().onAuthStateChanged(function (user) {
  if (user) {
    currentUser = user.uid;
        email = user.email;
    console.log("Provider: " + currentUser.provider);
        console.log(currentUser);
        console.log("Email: " + user.email);
        console.log("displayName: " + displayName);
      }

});

    var navListItems = $('ul.setup-panel li a'),
    //each form section is an allWells
        allWells = $('.setup-content');

    allWells.hide();

    navListItems.click(function(e)
    {
        e.preventDefault();
        var $target = $($(this).attr('href')),
            $item = $(this).closest('li');
        
        if (!$item.hasClass('disabled')) {
            navListItems.closest('li').removeClass('active');
            $item.addClass('active');
            allWells.hide();
            $target.show();
        }
    });
    
    $('ul.setup-panel li.active a').trigger('click');
    
    // DEMO ONLY //
    $('#activate-step-2').on('click', function(e) {
        $('ul.setup-panel li:eq(1)').removeClass('disabled');
        $('ul.setup-panel li a[href="#step-2"]').trigger('click');
        $(this).remove();
    })
    
    $('#activate-step-3').on('click', function(e) {
        $('ul.setup-panel li:eq(2)').removeClass('disabled');
        $('ul.setup-panel li a[href="#step-3"]').trigger('click');
        $(this).remove();
    })
    
    $('#activate-step-4').on('click', function(e) {
        $('ul.setup-panel li:eq(3)').removeClass('disabled');
        $('ul.setup-panel li a[href="#step-4"]').trigger('click');
        $(this).remove();
    })
    
    $('#activate-step-3').on('click', function(e) {
        $('ul.setup-panel li:eq(2)').removeClass('disabled');
        $('ul.setup-panel li a[href="#step-3"]').trigger('click');
        $(this).remove();
    })
});


// Add , Delete row dynamically

     $(document).ready(function(){
      var i=1;
      //add row button
     $("#add_row").click(function(){
        // grabs tr (tablerow) with relevant id adds one and then generates a new input 
      $('#addr'+i).html("<td>"+ (i+1) +"</td><td><input class='checkSym' name='name"+i+"' type='text' placeholder='Symptoms' class='form-control input-md'  /> </td>");
      // adds to the whole table and appends another row
      $('#tab_logic').append('<tr id="addr'+(i+1)+'"></tr>');
      i++; 
  });
     $("#delete_row").click(function(){
         if(i>1){
         $("#addr"+(i-1)).html('');
         i--;
         }
     });
     // PHYSICAL EXAM section
     //
     //
     var exami=1;
     $("#add_row_exam").click(function(){
        // grabs tr (tablerow) with relevant id adds one and then generates a new input 
      $('#examAddr'+exami).html("<td>"+ (exami+1) +"</td><td><input class='checkExam' name='exam"+exami+"' type='text' placeholder='Enter Physical Exam Item' class='form-control input-md'  /> </td>");
      // adds to the whole table and appends another row
      $('#tab_logic_exam').append('<tr id="examAddr'+(exami+1)+'"></tr>');
      exami++; 
  });
     $("#delete_row_exam").click(function(){
         if(exami>1){
         $("#examAddr"+(exami-1)).html('');
         exami--;
         }
     });
});

    //LAB SECTION
    //
    //
    var labi=1;
     $("#add_row_lab").click(function(){
        // grabs tr (tablerow) with relevant id adds one and then generates a new input 
      $('#labAddr'+labi).html("<td>"+ (labi+1) +"</td><td><input class='checkLab' name='exam"+labi+"' type='text' placeholder='Enter Lab' class='form-control input-md'  /> </td>");
      // adds to the whole table and appends another row
      $('#tab_logic_lab').append('<tr id="labAddr'+(labi+1)+'"></tr>');
      labi++; 
  });
     $("#delete_row_lab").click(function(){
         if(labi>1){
         $("#labAddr"+(labi-1)).html('');
         labi--;
         }
     });

//
//
// FORM SUBMISSION TO DB
//
$('#checkSubmit').on('click', function (e) {
    e.preventDefault();
    //Store Input in Variables
    // role = $('#txtEmail').val().trim();
    // use = $('#txtPassword').val().trim();
    var checkTitle = $('#checkTitle').val().trim();
    var symptomsArray = [];
    var examArray = [];
    var labsArray = [];
    var procArray = [];
    var medsArray = [];
   
   var userChecklist = {
        role: 'role',
        use: 'use',
        symptoms: symptomsArray,
        exam: examArray,
        labs: labsArray,
        proc: procArray,
        meds: medsArray
    };

    $( '.checkSym' ).each(function() {
    var eachSym = $( this ).val().trim();
    if(eachSym === ''){

    }else{
    symptomsArray.push(eachSym);
    }


  });
       $( '.checkExam' ).each(function() {
    var eachExam = $( this ).val().trim();
    if(eachExam === ''){

    }else{
    examArray.push(eachExam);
    }

  });
      $( '.checkLab' ).each(function() {
    var eachLab = $( this ).val().trim();
    if(eachLab === ''){

    }else{
    labsArray.push(eachLab);
    }


  });

var postData = {
            role: 'role',
            use: 'use',
            title: checkTitle,
            symptoms: symptomsArray,
            exam: examArray,
            labs: labsArray,
            proc: procArray,
            meds: medsArray,
            starCount: 0

        };

    var newPostKey = firebase.database().ref().child('checklists').push().key;

      var updates = {};
  updates['/posts/' + newPostKey] = postData;
  updates['/user-posts/' + currentUser + '/' + newPostKey] = postData;

firebase.database().ref().update(updates);
  
    console.log(userChecklist);
    // dataRef.update('users/'+ currentUser + '/checklists/' + newPostKey).set({
    //         role: 'role',
    //         use: 'use',
    //         title: checkTitle,
    //         symptoms: symptomsArray,
    //         exam: examArray,
    //         labs: labsArray,
    //         proc: procArray,
    //         meds: medsArray,
    //         starCount: 0

    //     });
    return false;
});

</script>
</body>
</html>